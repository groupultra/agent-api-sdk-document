## WS_URL

```
wss://ws.moobius.net
```

## Introduction

1. This document describes how websocket communication works on moobius; all functionalities that are not in this doc are implemented using HTTP APIs.
2. Anyone can establish public connections with the websocket, but it's required to login first to do anything. user_id or service_id is needed in any packets after the login.
3. User uses user_id and access_token to login, and service uses service_id and access_token to login. The access_token used by the service is the one that belongs to the user that the service belongs to.
4. One user or service can only login on one device. If login on other devices, the prior one will be signed out.
5. All data that are sent to or received are in the json format. Tabs, line-breaks and spaces can be ignored. Type, request_id, user_id (or service_id), body are required. Other infos are listed subject to their types.
6. All uuids mentioned below are uuid4.

```python
import uuid
print(str(uuid.uuid4()))
```

7. For every type, an example will be given, in json format. All values are generated randomly and cannot be used directly. Every field will be explained in detail in the corresponding tables.
8. For some types, structures for packets differ between send and receive. Developers may need to do different parsing. "generated by moobius" and "added by moobius" fields are not needed to add when sending; "culled by moobius" fields are deleted by moobius but are required to be handled by moobius.
9. Some interactions between users and channels (and services bound to them) are handled by moobius, for example, fetching channel lists. Channel cannot choose to be seen or not seen by some specified users. Join_channel and Leave_channel actions are initiated by users, and channel cannot induce users to launch these actions. Channel cannot kick out users, and cannot forbid users from joining; but channel can choose not to provide service to certain users, for example, listing empty character_list to them.
10. uuid[] are never sent. Always use group_id to refer to users. (by TheCat)
